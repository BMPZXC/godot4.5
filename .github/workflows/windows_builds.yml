name: ğŸ Windows Builds (Custom - No 3D/Physics/XR)
on:
  workflow_call:
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: windows-latest
    name: Editor (MSVC - No 3D)
    timeout-minutes: 90
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Setup Python and SCons
        uses: ./.github/actions/godot-deps

      - name: Compile Godot (No D3D12, No 3D)
        shell: bash
        run: |
          # ä½¿ç”¨ scons å‘½ä»¤è¡Œç›´æ¥ç¼–è¯‘ï¼Œé¿å…ä½¿ç”¨ godot-build action
          # è®¾ç½®æ‰€æœ‰å¿…è¦çš„å‚æ•°
          scons platform=windows \
                target=editor \
                dev_mode=yes \
                debug_symbols=no \
                # å…³é”®ï¼šç¦ç”¨ D3D12 åŠå…¶æ‰€æœ‰ç›¸å…³ä¾èµ–
                d3d12=no \
                # ç¦ç”¨ 3D ç›¸å…³åŠŸèƒ½
                disable_3d=yes \
                disable_physics_3d=yes \
                disable_xr=yes \
                module_godot_physics_3d_enabled=no \
                module_jolt_physics_enabled=no \
                module_msdfgen_enabled=no \
                # é™æ€åº“è·¯å¾„ï¼ˆå¦‚æœä¸éœ€è¦å¯ä»¥æ³¨é‡Šæ‰ï¼‰
                # "angle_libs=${{ github.workspace }}/" \
                # "accesskit_sdk_path=${{ github.workspace }}/accesskit-c-0.17.0/" \
                # æ§åˆ¶å°å­ç³»ç»Ÿ
                windows_subsystem=console

      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: godot-windows-editor-no3d
          path: bin/godot.windows.editor.x86_64.exe
